\section{Реккурентная формула для коэффициентов Тейлора неявных функций. Вывод и примеры использования.}

Пусть у нас есть некоторая непрерывно-дифференцируемая в окрестности $U \in \R^k \times \R^r$ функция $g(\tau, z)$, где $\tau \in \R^k$, $z \in \R^r$, для
которой выполнены условия теоремы о неявной функции. Точнее
\begin{gather*}
    g(\tau_0, z_0) = 0, \\
    \det J \neq 0,
\end{gather*}
где 
$$J(\tau, z) = \left(\frac{\partial}{\partial \tau_i} g_j(\tau, z)\right)_{i, j = 1}^m.$$

По теореме о неявной функции существует $\tau(z)$ такая, что $\tau(z_0) = \tau_0$ и $g(\tau(z), z) = 0$ в некоторой окрестности $z \in V$.
Также мы действуем в предположении, что $g$ является аналитической, а значит и $\tau$ будет являться аналитической по теореме о неявной функции.
Наша текущая цель научиться определять коэффициенты в разложении Тейлора функции $\tau(z)$ в окрестности точки $z_0$.
Начнем со случая $k = 1$.
$$ \tau(z) = \tau_{(0)} + \sum_{i=1}^\infty \tau_{(i)} z^i.$$
Положим $\tau_{(0)} = \tau_0$ для единообразия.
Обозначим $\tau_{<n>}(z) = \tau_{(0)} + \sum_{i=1}^n \tau_{(i)} z^i$ для всех $n \in \N_0$ и
$J_{(0)} \overset{\mathrm{def}}{=} J(\tau_0, z_0)$.
\begin{thm}[Рекуррентные формулы для коэффициентов Тейлора]
    $$\tau_{(n)} = -\frac{1}{n!} J_{(0)}^{-1} \frac{\partial g}{\partial z^n}\big(\tau_{<n - 1>}(z), z\big) \bigg |_{z = z_0}.$$
\end{thm}

\begin{proof}
TODO
\end{proof}

\begin{ex}
    Рассмотрим функцию $g(\tau, z) = \sin z - \ln \tau$, разложим ее в ряд Тейлора в окрестности точки $z_0 = 0$.
    $\tau_{(0)} = 1$, так как $g(\tau_0, z_0) = 0$.
    Ясно, что $J_{(0)} = -1$.
    Далее непосредственное вычисление показывает, что $\tau_{(1)} = 1$.
    Подробнее выпишем вычисление $\tau_{(2)}$.
    \begin{gather*}
        \tau_{(2)} = -\frac{1}{2} J_{(0)}^{-1} \big(g(\tau_{<1>}(z), z\big)' \big |_{z = z_0} = \frac{1}{2} (\sin z - \ln(1 + z))'' \big |_{z = z_0} = \\
        = \frac{1}{2} (-1) \left(\frac{1}{1 + z}\right)' = \frac{1}{2}.
    \end{gather*}
    Далее вычисления можно производить, сколь угодно долго.
\end{ex}

\begin{ex}
    Рассмотрим функцию $g(\tau, z) = \tau^3 + \tau^2 - 2\tau + z$, разложим ее в ряд Тейлора в окрестности точки $z_0 = 0$.
    $\tau_{(0)} = 1, -2, 0$, так как $g(\tau_0, z_0) = 0$.
    Выберем, например, $\tau_{(0)} = 0$.
    При этом $J(\tau, z) = 3 \tau^2 + 2\tau -2$, а значит $J_{(0)} = -2$.
    Далее непосредственное вычисление показывает, что $\tau_{(1)} = 1/2$.
\end{ex}

Здесь приводится изложение для многомерного случая, взятое целиком из пособия.

Известно (Фихтенгольц, 1966, с.~460), что производные неявных
функций могут быть вычислены рекуррентным образом с помощью метода
неопределенных коэффициентов. В данном разделе, следуя работе
(Мелас, Пепелышев, 1999), мы введем рекуррентные формулы,
ориентированные на использование пакетов символьных вычислений Maple
и Mathcad.

Пусть $m$ и $k$ --- произвольные натуральные числа,
$\tau=(\tau_1,\ldots,\tau_m) \in {\R}^m$, $z=(z_1,\ldots,z_k)\in
{\R}^k$ и $g(\tau,z)=(g_1(\tau,z), \ldots,g_m(\tau,z))$ ---
вещественная аналитическая вектор-функция в некоторой окрестности
$U$ точки $(\tau_{(0)},z_{(0)})$, такая, что
$g(\tau_{(0)},z_{(0)})=0$.

Для любого набора индексов $s=(s_1,\ldots,s_k)$, $s_i\geq 0$,
$i=1,\ldots,k$ и любой (скалярной, векторной или матричной)
вещественной аналитической функции $f$ обозначим
$$
f_{(s)}=\left(f(z)\right)_{(s)}=\frac{1}{s_1!\ldots s_k!}
\frac{\partial^{s_1}}{\partial z_1^{s_1}}\ldots
\frac{\partial^{s_k}}{\partial z_k^{s_k}} f(z)|_{z=z_{(0)}}.
$$

Обозначим
$$
S_t=\{s=(s_1,\ldots,s_k);\quad s_i\geq 0,\quad \sum^k_{i=1} s_i=t\}
$$
при $t=0,1,\ldots$.

Пусть $l=(l_1,\ldots,l_k)$,$l_i\geq 0$ --- заданный вектор целых
чисел.

Предположим, что функция $g$ имеет вид
$$
g(\tau,z)=(z_1-z_{1(0)})^{l_1}\ldots (z_k-z_{k(0)})^{l_k}
\psi(z)\tilde g(\tau,z),
$$
где $\psi(z)$ --- однородный многочлен степени $p\geq 0$,
$$
\psi(z)=\sum_{s\in S_p}a_{(s)}(z_1-z_{1(0)})^{s_1}\ldots
(z_k-z_{k(0)})^{s_k},
$$
такой, что $a_{(p,0,\ldots,0)}\ne 0$, причем $\det \tilde
J(\tau_{(0)},z_{(0)})\ne 0$, где
$$
\tilde J(\tau,z)=\frac{\partial}{\partial\tau}\tilde g(\tau,z).
$$

Рассмотрим уравнение
$$
g(\tau,z)=0.
$$
При $z_i\ne z_j$, $(i\ne j)$, $z_i\ne z_{i(0)}$, $i,j=1,\ldots,k$ и
при $\psi(z)$ таком, что $\psi(z)\ne 0$ при $z_i\ne z_j$, $i\ne j$,
$z_i\ne z_{i(0)}$, $i,j=1,\ldots,k$, это уравнение эквивалентно
уравнению
$$
\tilde g(\tau,z)=0.
$$

Легко проверить, что функция $\tilde g(\tau,z)$ является
вещественной аналитической при $(\tau,z)\in U$.

В силу теоремы о неявной функции (Бибиков, 1991, с.\,173) существует
вектор-функция $\tau^*(z)$,\, которая\, является\,
ве\-ще\-ст\-вен\-ной аналитической вектор-функцией в некоторой
окрестности $H$ точки $\tau=\tau_{(0)}$, и такая, что
$\tau^*(z_{(0)})=\tau_{(0)}$, $(\tau^*(z),z)\in U$ и $\tilde
g(\tau^*(z),z)=0$, а значит и $ g(\tau^*(z),z)=0$ при $z\in H$. Эта
вектор-функция в некоторой окрестности $H^*\subset H$ точки
$z_{(0)}$ разлагается в (сходящийся) ряд Тейлора:
$$
\tau^*(z)=\tau_{(0)}+ \sum^\infty_{t=1}\sum_{s\in S_t}
\tau^*_{(s)}(z_1- z_{1(0)})^{s_1}\ldots(z_k-z_{k(0)})^{s_k}.
$$
Отметим, что при $k=1$ множество $S_t$ состоит из одного элемента
$s=s_t=t$.

Построим рекуррентные формулы для вычисления коэффициентов
$\tau^*_{(s)}$, $s\in S_t$, $t=1,2,\ldots$.

Пусть $I$\,---\,произвольное\,множество\,индексов
вида\,$s=(s_1,\ldots,s_k)$, $s_i\geq 0$, $i=1,\ldots,k$.

Обозначим
$$
\tau_{<I>}(z)=\sum_{s\in I}\tau_{(s)}(z_1-z_{1(0)})^{s_1}\ldots
(z_k- z_{k(0)})^{s_k},
$$
$$
J(\tau,z)=\frac{\partial}{\partial \tau}g(\tau,z),\quad
J_{(l)}=\left(J(\tau_{(0)},z)\right)_{(l)}.
$$

Пусть сначала $p=0$.

Введем множество индексов
$$
I_n=U^n_{t=0}S_t.
$$

Тогда имеет место следующее утверждение.

{\bf Предложение 2.5.1.}
 При сформулированных выше условиях
имеют место следующие формулы
$$
\tau^*_{(s)}=-J^{-1}_{(l)}g(\tau^*_{<I>}(z),z)_{(s+l)}
$$
при $s\in S_t$,  $I=I_{t-1}$, $t=1,2,\ldots$

Доказательство этого и следующего предложения будет дано в конце
раздела.

С помощью предложения 2.5.1 можно построить рекуррентный алгоритм
вычисления коэффициентов разложения функции $\tau^*(z)$ в ряд
Тейлора при $p=0$ и произвольном $l=(l_1,\ldots,l_k)$, $l_i\geq 0$,
$i=1,\ldots,k$.

{\bf Алгоритм 1.} На шаге $t$ $(t=1,2,\ldots)$ вычисляем все
коэффициенты с индексами из $S_t$ по формуле
$$
\tau_{(s)}=-J^{-1}_{(l)}\left(g(\tau_{<I_{t-1}>}(z),z\right)_{(s+l)}.
$$

Из Предложения 2.5.1 вытекает, что $\tau_{(s)}=\tau^*_{(s)}$, $s\in
S_t$, $t=1,2,\ldots$.

Рассмотрим теперь случай $p>0$. Определим множество индексов
$$
\hat S_t=\{s=(s_1,\ldots,s_k);s_i\geq
0,i=1,\ldots,k,s_1+2\sum^k_{i=2} s_i=t\}.
$$

Пусть $\hat I_n= U^n_{t=0}\hat S_t$, $q=(p,0,\ldots,0)$.

Пусть $J_{(l+q)}=\left(J(\tau_{(0)},z)\right)_{(l+q)}$.


{\bf Предложение 2.5.2.} {\it При $p>0$ имеют место формулы
$$
\tau^*_{(s)}=-J^{-1}_{(l+q)}
g\left(\tau^*_{<I>}(z),z\right)_{(s+l+q)}
$$
при $s\in \hat S_t$, $I=\hat I_{t-1}$, $t=1,2,\ldots$. }

Алгоритм вычисления коэффициентов $\tau^*_{(s)}$ получаем из
Алгоритма 1 заменой множества $S_t$ на $\hat S_t$.

